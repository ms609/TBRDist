---
title: "Using _uspr_"
author: "Martin R. Smith"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
bibliography: ../inst/REFERENCES.bib
csl: ../inst/apa-old-doi-prefix.csl
vignette: >
  %\VignetteIndexEntry{Using uSPR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

_uspr_ is a package to compare phylogenetic trees.

This vignette assumes familiarity with the process of [loading trees into R](https://ms609.github.io/TreeTools/articles/load-trees.html).

To load the `uspr` library into the R namespace, use 

```{r}
library('uspr')
```

We'll work with some simple trees generated using the 
[`TreeTools`](https://ms609.github.io/TreeTools) package.

```{r, fig.width=80%}
library('TreeTools')
tree1 <- BalancedTree(10)
tree2 <- TreeTools::PectinateTree(10)
par(mfrow=1:2, mar=rep(0.2, 4)) # Set up plotting area
plot(tree1)
plot(tree2)
```

To generate an approximate SPR distance between two unrooted trees, use:

```{r}
USPRDist(tree1, tree2)
```

For TBR distances, use:

```{r}
TBRDist(tree1, tree2)
```

When calculating an exact TBR distance, we receive information on the
maximum agreement forest for free (i.e. with no extra processing cost):

```{r}
TBRDist(tree1, tree2, returnMaf = TRUE)
```

For larger trees, we may wish to approximate the value of the TBR distance for 
a faster result:

```{r}
TBRDist(tree1, tree2, exact = FALSE)
```

<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate SPR, TBR and Replug distances on unrooted trees — TreeRearrangementDistances • TBRDist</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate SPR, TBR and Replug distances on unrooted trees — TreeRearrangementDistances" />
<meta property="og:description" content="Calculate SPR, TBR and Replug distances on unrooted trees, and the
information content of the maximum agreement forest." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TBRDist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/TBRDist.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ms609/TBRDist/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate SPR, TBR and Replug distances on unrooted trees</h1>
    <small class="dont-index">Source: <a href='https://github.com/ms609/TBRDist/blob/master/R/uspr.R'><code>R/uspr.R</code></a></small>
    <div class="hidden name"><code>TreeRearrangementDistances.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate SPR, TBR and Replug distances on unrooted trees, and the
information content of the maximum agreement forest.</p>
    </div>

    <pre class="usage"><span class='fu'>USPRDist</span>(
  <span class='no'>tree1</span>,
  <span class='kw'>tree2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>allPairs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span>(<span class='no'>tree2</span>),
  <span class='kw'>checks</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>useTbrApproxEstimate</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>useTbrEstimate</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>useReplugEstimate</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)

<span class='fu'>ReplugDist</span>(
  <span class='no'>tree1</span>,
  <span class='kw'>tree2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>allPairs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span>(<span class='no'>tree2</span>),
  <span class='kw'>checks</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>maf</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)

<span class='fu'>TBRDist</span>(
  <span class='no'>tree1</span>,
  <span class='kw'>tree2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>allPairs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span>(<span class='no'>tree2</span>),
  <span class='kw'>checks</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>maf</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>countMafs</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>printMafs</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>exact</span> <span class='kw'>=</span> <span class='no'>maf</span>,
  <span class='kw'>approximate</span> <span class='kw'>=</span> !<span class='no'>exact</span>,
  <span class='kw'>optimize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>protectB</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)

<span class='fu'>MAFInfo</span>(<span class='no'>tree1</span>, <span class='kw'>tree2</span> <span class='kw'>=</span> <span class='no'>tree1</span>, <span class='kw'>exact</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tree1, tree2</th>
      <td><p>Trees of class <code>phylo</code>, or lists thereof.</p></td>
    </tr>
    <tr>
      <th>allPairs</th>
      <td><p>Logical; if <code>TRUE</code>, compare each tree in <code>tree1</code> with each
tree in <code>tree2</code>; if <code>FALSE</code>, compare each tree in <code>tree1</code> only with the
tree at the corresponding index in <code>tree2</code>.  If <code>tree2</code> is not specified,
each tree in <code>tree1</code> will be compared with each other tree in <code>tree1</code>.</p></td>
    </tr>
    <tr>
      <th>checks</th>
      <td><p>Logical specifying whether to check that trees are properly
formatted and labelled.  Specify <code>FALSE</code> at your peril, as improper
input is likely to crash R.</p></td>
    </tr>
    <tr>
      <th>useTbrApproxEstimate, useTbrEstimate, useReplugEstimate</th>
      <td><p>Logical
specifying whether to use approximate TBR distance, TBR distance or Replug
distance to help estimate the SPR distance.</p></td>
    </tr>
    <tr>
      <th>maf</th>
      <td><p>Logical specifying whether to report a maximum agreement forest
corresponding to the optimal score.</p></td>
    </tr>
    <tr>
      <th>countMafs</th>
      <td><p>Logical specifying whether to count the number of maximum
agreement forests found.</p></td>
    </tr>
    <tr>
      <th>printMafs</th>
      <td><p>Logical specifying whether to print maximum agreement
forests to stdout whilst counting.
Use <code><a href='https://rdrr.io/r/utils/capture.output.html'>capture.output</a></code><code>(TBRDist(tree1, tree2, printMafs = TRUE))</code> to access
these in R.</p></td>
    </tr>
    <tr>
      <th>exact</th>
      <td><p>Logical specifying whether to calculate the exact TBR distance.</p></td>
    </tr>
    <tr>
      <th>approximate</th>
      <td><p>Logical specifying whether to calculate the approximate
TBR distance.  By default, is set to the opposite of <code>exact</code>; either
<code>approximate</code> or <code>exact</code> should usually be set to <code>TRUE</code> if a distance is
required.</p></td>
    </tr>
    <tr>
      <th>optimize</th>
      <td><p>Logical specifying whether to use the default optimizations.</p></td>
    </tr>
    <tr>
      <th>protectB</th>
      <td><p>Logical specifying whether to use the 'PROTECT_B'
optimization.
Overrides value inherited from <code>optimize</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>USPRDist()</code> returns a vector of SPR distances between each pair of
unrooted trees.</p>
<p><code>ReplugDist()</code> returns a vector of Replug distances between each pair
of trees, or (if <code>maf = TRUE</code>) a named list whose second and third elements
list a vector of maximum agreement forests for each pair of trees.</p>
<p><code>TBRDist()</code> returns a named list, each element of which bears a
vector corresponding to the requested value for each tree pair.  If only the
exact value is requested (<code>exact = TRUE</code>), an unnamed vector of distances is
returned.</p>
<p><code>MAFInfo()</code> returns the information content of the maximum agreement
forest, in bits.  This is defined as the sum of the phylogenetic information
content of each constituent subtree, plus the entropy of the clusters implied
by the division of the tree into subtrees.  Note that as there is no
guarantee that the most informative MAF will be encountered,
this measure is approximate only.  <code>exact</code> will only serve to guarantee
that a MAF corresponding to the exact TBR distance is among those sampled.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Note that these distances are NP-hard to compute, so the running time of the
algorithms used in this software scale exponentially with the distance
computed.
The version of 'uspr' linked in this package is aimed at trees with up to
50 leaves and uSPR distances up to 14.</p>
<p>If you are interested in comparing rooted trees in terms of SPR operations,
you should use '<a href='https://github.com/cwhidden/rspr/'>rspr</a>' instead.
'rspr' is also much more efficient and can easily handle pairs of binary
rooted trees with 200+ leaves and distances &gt; 50.
rspr is not yet incorporated in this R package; please
<a href='https://github.com/ms609/TBRDist/issues/2/'>contact the maintainer</a>
if this would be useful to you.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>If you use these functions in your research, please cite:</p><ul>
<li><p>Chris Whidden and Frederick A. Matsen IV. Calculating the Unrooted
Subtree-Prune-and-Regraft Distance.
arXiv:<a href='http://arxiv.org/abs/1511.07529'>1511.07529</a>.</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>tree1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TreeTools</span><span class='kw ns'>::</span><span class='fu'><a href='https://ms609.github.io/TreeTools/reference/GenerateTree.html'>BalancedTree</a></span>(<span class='fl'>9</span>)
<span class='no'>tree2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TreeTools</span><span class='kw ns'>::</span><span class='fu'><a href='https://ms609.github.io/TreeTools/reference/GenerateTree.html'>PectinateTree</a></span>(<span class='fl'>9</span>)

<span class='co'># SPR distance</span>
<span class='fu'>USPRDist</span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>)</div><div class='output co'>#&gt; [1] 2</div><div class='input'><span class='co'># Replug distance</span>
<span class='fu'>ReplugDist</span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>)</div><div class='output co'>#&gt; [1] 2</div><div class='input'><span class='fu'>ReplugDist</span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>, <span class='kw'>maf</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; $replug_dist
#&gt; [1] 2
#&gt; 
#&gt; $maf_1
#&gt; [1] "((((0,1),2),3),(7,8),5); (*,4); (*,6);"
#&gt; 
#&gt; $maf_2
#&gt; [1] "((((0,1),2),3),(7,8),5); (*,4); (*,6);"
#&gt; </div><div class='input'><span class='no'>tree1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TreeTools</span><span class='kw ns'>::</span><span class='fu'><a href='https://ms609.github.io/TreeTools/reference/GenerateTree.html'>BalancedTree</a></span>(<span class='fl'>6</span>)
<span class='no'>tree2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TreeTools</span><span class='kw ns'>::</span><span class='fu'><a href='https://ms609.github.io/TreeTools/reference/GenerateTree.html'>PectinateTree</a></span>(<span class='fl'>6</span>)

<span class='co'># TBR distance between two trees</span>
<span class='fu'>TBRDist</span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>, <span class='kw'>exact</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; [1] 1</div><div class='input'>
<span class='co'># Compare a list against one tree, using approximate distances</span>
<span class='fu'>TBRDist</span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>), <span class='no'>tree2</span>, <span class='kw'>exact</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; $tbr_min
#&gt; [1] 1 0
#&gt; 
#&gt; $tbr_max
#&gt; [1] 3 0
#&gt; </div><div class='input'>
<span class='co'># Compare all pairs in two lists</span>
<span class='fu'>TBRDist</span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>), <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>, <span class='no'>tree2</span>), <span class='kw'>allPairs</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
        <span class='kw'>exact</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; $tbr_min
#&gt;      [,1] [,2] [,3]
#&gt; [1,]    0    1    1
#&gt; [2,]    1    0    0
#&gt; 
#&gt; $tbr_max
#&gt;      [,1] [,2] [,3]
#&gt; [1,]    0    3    3
#&gt; [2,]    3    0    0
#&gt; </div><div class='input'>
<span class='co'># Compare each tree in a list against each other</span>
<span class='fu'>TBRDist</span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>one</span> <span class='kw'>=</span> <span class='no'>tree1</span>, <span class='kw'>two</span> <span class='kw'>=</span> <span class='no'>tree2</span>, <span class='kw'>twoAgain</span> <span class='kw'>=</span> <span class='no'>tree2</span>))</div><div class='output co'>#&gt; $tbr_min
#&gt;          one two
#&gt; two        1    
#&gt; twoAgain   1   0
#&gt; 
#&gt; $tbr_max
#&gt;          one two
#&gt; two        3    
#&gt; twoAgain   3   0
#&gt; </div><div class='input'>
<span class='co'># Compare each pair in two lists</span>
<span class='fu'>TBRDist</span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>, <span class='no'>tree2</span>),
        <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>tree2</span>, <span class='no'>tree1</span>, <span class='no'>tree2</span>),
        <span class='kw'>exact</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>approximate</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>countMafs</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; $tbr_exact
#&gt; [1] 1 1 0
#&gt; 
#&gt; $tbr_min
#&gt; [1] 1 1 0
#&gt; 
#&gt; $tbr_max
#&gt; [1] 3 3 0
#&gt; 
#&gt; $n_maf
#&gt; [1] 4 4 1
#&gt; </div><div class='input'>
<span class='co'># Capture maximum agreement forests</span>
<span class='no'>mafs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/capture.output.html'>capture.output</a></span>(<span class='fu'>TBRDist</span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>, <span class='kw'>approximate</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                        <span class='kw'>printMafs</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>mafs</span>)</div><div class='output co'>#&gt; [1] "((0,1),(3,4),2); 5;" "((0,1),(3,4),2); 5;" "(0,1,2); (5,4,3);"  
#&gt; [4] "(0,1,2); (3,5,4);"   "(((0,1),2),4,5); 3;" "(((0,1),2),4,5); 3;"</div><div class='input'>
<span class='fu'>MAFInfo</span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>)</div><div class='output co'>#&gt; [1] 4.556913</div><div class='input'><span class='fu'>MAFInfo</span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>tree2</span>, <span class='no'>tree1</span>), <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>))</div><div class='output co'>#&gt;          [,1]     [,2]
#&gt; [1,] 4.556913 6.714246
#&gt; [2,] 6.714246 4.556913</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://community.dur.ac.uk/martin.smith/'>Martin R. Smith</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


